<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC 
			"-//mybatis.org//DTD Mapper 3.0//EN" 
			"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
			
<mapper namespace="com.itbank.model.BoardDAO">
	<select id="selectAll" resultType="board">
		select * from board
			where 
				deleted = 'n'
			order by 
				idx desc
	</select>
	
	<select id="selectSearch" parameterType="hashmap" resultType="board">
		select * from board
			where 
				deleted = 'n' and
				${type} like '%${search}%'
			order by 
				idx desc
	</select>
	
	<select id="selectOne" parameterType="int" resultType="board">
		select * from board where idx = #{idx}
	</select>
	
	<insert id="insert" parameterType="board">
		insert into 
		    board 
		        (idx, title, writer, content, password, uploadFile, ipaddr)
		    values
		        (board_seq.nextval, 
		        	#{title}, 
		        	#{writer}, 
		        	#{content}, 
		        	#{password}, 
		        	'${uploadFile}', 
		        	#{ipaddr}
		        )
	</insert>
	
	<select id="selectMaxIdx" resultType="int">
		select max(idx) from board
	</select>
	
	<update id="updateViewCount" parameterType="int">
		update board set viewCount = viewCount + 1 where idx = #{idx}
	</update>
	
	<update id="deleteBoard" parameterType="hashmap">
		update board 
			set deleted = 'y'
			where
				idx = #{idx} and
				password = #{password}
	</update>
	
	<select id="checkPassword" resultType="int" parameterType="board">
		select idx from board 
			where
				idx = #{idx} and
				password = #{password}
	</select>
	
	<update id="modify" parameterType="board">
		update board set
			title = #{title},
			writer = #{writer},
			content = #{content},
			uploadFile = '${uploadFile}',
			ipaddr = #{ipaddr}
		where
			idx = #{idx} and
			password = #{password}
	</update>
</mapper>





